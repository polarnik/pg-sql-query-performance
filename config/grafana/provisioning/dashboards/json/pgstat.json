{"meta":{"type":"db","canSave":true,"canEdit":true,"canAdmin":true,"canStar":true,"slug":"postgresql-query-statistics","url":"/d/pgstat/postgresql-query-statistics","expires":"0001-01-01T00:00:00Z","created":"2021-05-24T22:02:42Z","updated":"2021-05-24T22:04:52Z","updatedBy":"Anonymous","createdBy":"Anonymous","version":2,"hasAcl":false,"isFolder":false,"folderId":0,"folderTitle":"General","folderUrl":"","provisioned":false,"provisionedExternalId":"pgstat.json"},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"$db_jmeter","enable":true,"hide":false,"iconColor":"#E02F44","limit":100,"name":"(start)","query":"select text,generatorHost,application,title FROM (select text from events where $timeFilter and \"text\" =~ /.*started$/ GROUP BY generatorHost,application,title)","showIn":0,"tags":[],"tagsColumn":"generatorHost,application,title","textColumn":"text","type":"tags"},{"datasource":"$db_jmeter","enable":true,"hide":false,"iconColor":"#e5ac0e","name":"(stop)","query":"select \"text\", \"generatorHost\", \"application\" FROM (select text from events where $timeFilter and \"text\" =~ /.*ended$/ GROUP BY  \"generatorHost\", \"application\")","showIn":0,"tagsColumn":"application,generatorHost","textColumn":"text"},{"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#8F3BB8","limit":100,"matchAny":true,"name":"Events (Demo stand)","showIn":0,"tags":["Demo"],"type":"tags"}]},"editable":true,"gnetId":null,"graphTooltip":2,"id":6,"iteration":1621893869215,"links":[],"panels":[{"datasource":"$db","fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":2,"w":14,"x":0,"y":0},"id":32,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"/.*/","values":false},"text":{},"textMode":"auto"},"pluginVersion":"","targets":[{"groupBy":[{"params":["host"],"type":"tag"}],"measurement":"pg_stat_statements_query_md5","orderByTime":"ASC","policy":"$archive","query":"SELECT \"host\", top(\"factor\", 1) FROM\n(SELECT (sum(\"duration_sum\")*sum(\"calls_sum\")) as \"factor\" FROM \"$archive\".\"pg_stat_statements_query_md5_10min\" WHERE $timeFilter GROUP BY \"host\")","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration_10m"],"type":"field"},{"params":[],"type":"sum"}],[{"params":["calls_10m"],"type":"field"},{"params":[],"type":"sum"}]],"tags":[]}],"timeFrom":null,"timeShift":null,"transformations":[{"id":"organize","options":{"excludeByName":{"Time":true,"top":true},"indexByName":{},"renameByName":{"host":"Host (master):"}}}],"transparent":true,"type":"stat"},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":2},"id":28,"panels":[],"title":"Statistics: Host / Database / User","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$db","fieldConfig":{"defaults":{},"overrides":[]},"fill":7,"fillGradient":0,"gridPos":{"h":5,"w":12,"x":0,"y":3},"hiddenSeries":false,"id":14,"interval":"10m","legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":true,"min":false,"rightSide":true,"show":true,"sideWidth":230,"sort":"max","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"maxDataPoints":1000,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"alias":"$tag_host","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["host"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":false,"measurement":"pg_stat_statements_query_md5_10min","orderByTime":"ASC","policy":"$archive","refId":"C","resultFormat":"time_series","select":[[{"params":["duration_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":[" *60 /( $__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"host","operator":"=~","value":"/^$host$/"}]},{"alias":"$tag_host (*)","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["host"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":true,"measurement":"pg_stat_statements_query_md5","orderByTime":"ASC","policy":"$archive","refId":"A","resultFormat":"time_series","select":[[{"params":["duration_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":[" *60 /( $__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"time","operator":"\u003c","value":"now()-$new"}]},{"alias":"$tag_host","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["host"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":true,"measurement":"pg_stat_statements_diff","orderByTime":"ASC","policy":"$new","refId":"B","resultFormat":"time_series","select":[[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":["*60  / ( $__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"time","operator":"\u003e","value":"now()-$new"}]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total Duration / min","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"transparent":true,"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:666","format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:667","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$db","decimals":1,"fieldConfig":{"defaults":{},"overrides":[]},"fill":6,"fillGradient":0,"gridPos":{"h":5,"w":12,"x":12,"y":3},"hiddenSeries":false,"id":13,"interval":"10m","legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":true,"min":false,"rightSide":true,"show":true,"sideWidth":230,"sort":"max","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxDataPoints":1000,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"alias":"$tag_host","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["host"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":false,"measurement":"pg_stat_statements_query_md5_10min","orderByTime":"ASC","policy":"$archive","refId":"B","resultFormat":"time_series","select":[[{"params":["calls_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":["  / ($__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"host","operator":"=~","value":"/^$host$/"}]},{"alias":"$tag_host","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["host"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":true,"measurement":"pg_stat_statements_diff","orderByTime":"ASC","policy":"$new","refId":"A","resultFormat":"time_series","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["  / ($__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"time","operator":"\u003e","value":"now()-$new"}]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total Calls / sec","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"transparent":true,"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:778","format":"ops","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:779","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$db","decimals":2,"fieldConfig":{"defaults":{},"overrides":[]},"fill":3,"fillGradient":0,"gridPos":{"h":5,"w":12,"x":0,"y":8},"hiddenSeries":false,"id":12,"interval":"10m","legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":true,"min":false,"rightSide":true,"show":true,"sideWidth":230,"sort":"max","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxDataPoints":1000,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":true,"targets":[{"alias":"$tag_datname","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["datname"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":false,"measurement":"pg_stat_statements_query_md5_10min","orderByTime":"ASC","policy":"$archive","refId":"B","resultFormat":"time_series","select":[[{"params":["duration_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":[" * 60 / ($__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"datname","operator":"=~","value":"/^$datname$/"}]},{"alias":"$tag_datname","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["datname"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":true,"measurement":"pg_stat_statements_diff","orderByTime":"ASC","policy":"$new","refId":"A","resultFormat":"time_series","select":[[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":[" * 60 / ($__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"time","operator":"\u003e","value":"now()-$new"}]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total Duration / min","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:2226","format":"ms","label":null,"logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:2227","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$db","decimals":1,"fieldConfig":{"defaults":{},"overrides":[]},"fill":3,"fillGradient":0,"gridPos":{"h":5,"w":12,"x":12,"y":8},"hiddenSeries":false,"id":15,"interval":"10m","legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":true,"min":false,"rightSide":true,"show":true,"sideWidth":230,"sort":"total","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxDataPoints":1000,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":true,"targets":[{"alias":"$tag_datname","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["datname"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":false,"measurement":"pg_stat_statements_query_md5_10min","orderByTime":"ASC","policy":"$archive","refId":"A","resultFormat":"time_series","select":[[{"params":["calls_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":["/ ($__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"datname","operator":"=~","value":"/^$datname$/"}]},{"alias":"$tag_datname","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["datname"],"type":"tag"},{"params":["null"],"type":"fill"}],"hide":true,"measurement":"pg_stat_statements_diff","orderByTime":"ASC","policy":"$new","refId":"B","resultFormat":"time_series","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["/ ($__interval_ms / 1000)"],"type":"math"}]],"tags":[{"key":"time","operator":"\u003e","value":"now()-$new"}]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total Calls / sec","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:887","format":"ops","label":null,"logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:888","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"columns":[],"datasource":"$db","fieldConfig":{"defaults":{},"overrides":[]},"fontSize":"100%","gridPos":{"h":6,"w":24,"x":0,"y":13},"id":8,"interval":"10m","links":[],"pageSize":5,"scroll":false,"showHeader":true,"sort":{"col":4,"desc":true},"styles":[{"$$hashKey":"object:300","alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"hidden"},{"$$hashKey":"object:301","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"mappingType":1,"pattern":"Calls","thresholds":[],"type":"number","unit":"none"},{"$$hashKey":"object:302","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Total","thresholds":[],"type":"number","unit":"ms"},{"$$hashKey":"object:303","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Max","thresholds":[],"type":"number","unit":"ms"},{"$$hashKey":"object:304","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Mean","thresholds":[],"type":"number","unit":"ms"},{"$$hashKey":"object:305","alias":"","align":"auto","colorMode":"cell","colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"% Shared Hit","thresholds":["0.1","0.7"],"type":"number","unit":"percentunit"},{"$$hashKey":"object:306","alias":"","align":"auto","colorMode":"cell","colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"% Local Hit","thresholds":["0.1","0.7"],"type":"number","unit":"percentunit"},{"$$hashKey":"object:307","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"mappingType":1,"pattern":"Rows","thresholds":[],"type":"number","unit":"none"},{"$$hashKey":"object:308","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"}],"hide":false,"measurement":"pg_stat_statements_query_md5_10min","orderByTime":"ASC","policy":"$archive","query":"","rawQuery":false,"refId":"A","resultFormat":"table","select":[[{"params":["calls_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["duration_sum"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls_sum\")"],"type":"math"},{"params":["Mean"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"}]},{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"}],"hide":true,"measurement":"pg_stat_statements_diff","orderByTime":"ASC","policy":"$new","query":"","rawQuery":false,"refId":"B","resultFormat":"table","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["max_time"],"type":"field"},{"params":[],"type":"max"},{"params":["Max"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls\")"],"type":"math"},{"params":["Mean"],"type":"alias"}],[{"params":["shared_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\"))"],"type":"math"},{"params":["% Shared Hit"],"type":"alias"}],[{"params":["local_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\"))"],"type":"math"},{"params":["% Local Hit"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"},{"condition":"AND","key":"time","operator":"\u003e","value":"now()-$new"}]},{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"}],"hide":true,"measurement":"pg_stat_statements_query_md5","orderByTime":"ASC","policy":"$archive","query":"","rawQuery":false,"refId":"C","resultFormat":"table","select":[[{"params":["calls_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["max_time_10m"],"type":"field"},{"params":[],"type":"max"},{"params":["Max"],"type":"alias"}],[{"params":["duration_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls_10m\")"],"type":"math"},{"params":["Mean"],"type":"alias"}],[{"params":["shared_blks_hit_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"shared_blks_hit_10m\") + sum(\"shared_blks_read_10m\"))"],"type":"math"},{"params":["% Shared Hit"],"type":"alias"}],[{"params":["local_blks_hit_10m"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"local_blks_hit_10m\") + sum(\"local_blks_read_10m\"))"],"type":"math"},{"params":["% Local Hit"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"}]}],"title":"$db Statistic","transform":"table","transformations":[{"id":"organize","options":{"excludeByName":{},"indexByName":{"Calls":5,"Max":8,"Mean":6,"Rows":7,"Time":0,"Total":4,"datname":2,"host":1,"usename":3},"renameByName":{}}}],"transparent":true,"type":"table-old"},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":19},"id":24,"panels":[],"title":"Statistics: Query - TOP ${TOP} by ${TOP_by}","type":"row"},{"datasource":"$db","fieldConfig":{"defaults":{"custom":{"align":null,"filterable":false,"width":95},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[{"matcher":{"id":"byName","options":"Rows"},"properties":[{"id":"unit","value":"short"},{"id":"decimals","value":1}]},{"matcher":{"id":"byName","options":"Total"},"properties":[{"id":"unit","value":"ms"},{"id":"decimals","value":2}]},{"matcher":{"id":"byName","options":"query"},"properties":[{"id":"custom.width"},{"id":"custom.displayMode","value":"color-text"}]},{"matcher":{"id":"byName","options":"Mean"},"properties":[{"id":"unit","value":"ms"},{"id":"decimals","value":1}]},{"matcher":{"id":"byName","options":"host"},"properties":[{"id":"links","value":[{"targetBlank":false,"title":"host: ${__data.fields[host]} (filter)","url":"${current}?from=${__from}\u0026to=${__to}\u0026var-db_jmeter=${db_jmeter:percentencode}\u0026var-db=${db:percentencode}\u0026var-host=${__data.fields[host]}\u0026var-archive=${archive}\u0026var-new=${new}\u0026var-TOP=${TOP}\u0026var-TOP_by=${TOP_by}\u0026var-current=${current}\u0026var-detail=${detail}"}]},{"id":"custom.width","value":110}]},{"matcher":{"id":"byName","options":"datname"},"properties":[{"id":"links","value":[{"title":"host: ${__data.fields[host]} + datname: ${__data.fields[datname]} (filter)","url":"${current}?from=${__from}\u0026to=${__to}\u0026var-db_jmeter=${db_jmeter:percentencode}\u0026var-db=${db:percentencode}\u0026var-host=${__data.fields[host]}\u0026var-datname=${__data.fields[datname]}\u0026var-archive=${archive}\u0026var-new=${new}\u0026var-TOP=${TOP}\u0026var-TOP_by=${TOP_by}\u0026var-current=${current}\u0026var-detail=${detail}"}]},{"id":"custom.width","value":100}]},{"matcher":{"id":"byName","options":"% Local Hit"},"properties":[{"id":"max","value":1},{"id":"min","value":0},{"id":"unit","value":"percentunit"},{"id":"custom.displayMode","value":"color-background"},{"id":"thresholds","value":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"orange","value":0.5},{"color":"green","value":0.8}]}},{"id":"custom.width","value":60}]},{"matcher":{"id":"byName","options":"queryid"},"properties":[{"id":"links","value":[{"targetBlank":true,"title":"","url":"/d/pgquery/postgresql-query-details?from=${__from}\u0026to=${__to}\u0026var-db_jmeter=${db_jmeter}\u0026var-db=${db}\u0026var-host=${__data.fields[host]}\u0026var-datname=${__data.fields[datname]}\u0026var-usename=${__data.fields[usename]}\u0026var-queryid=${__data.fields[queryid]}"}]},{"id":"custom.width","value":100}]},{"matcher":{"id":"byName","options":"usename"},"properties":[{"id":"links","value":[{"title":"host: ${__data.fields[host]} + datname: ${__data.fields[datname]} + usename: ${__data.fields[usename]} (filter)","url":"${current}?from=${__from}\u0026to=${__to}\u0026var-db_jmeter=${db_jmeter:percentencode}\u0026var-db=${db:percentencode}\u0026var-host=${__data.fields[host]}\u0026var-datname=${__data.fields[datname]}\u0026var-usename=${__data.fields[usename]}\u0026var-archive=${archive}\u0026var-new=${new}\u0026var-TOP=${TOP}\u0026var-TOP_by=${TOP_by}\u0026var-current=${current}\u0026var-detail=${detail}"}]},{"id":"custom.width","value":90}]},{"matcher":{"id":"byName","options":"Calls"},"properties":[{"id":"decimals","value":1},{"id":"unit","value":"short"}]}]},"gridPos":{"h":28,"w":24,"x":0,"y":20},"id":22,"links":[],"options":{"showHeader":true,"sortBy":[{"desc":true,"displayName":"Mean"}]},"pluginVersion":"","targets":[{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"},{"params":["query"],"type":"tag"}],"hide":true,"measurement":"pg_stat_statements_analyse","orderByTime":"ASC","policy":"$new","query":"SELECT top(\"${TOP_by}\", ${TOP}), \"Calls\", \"Total\", \"Rows\",\"Mean\",\"% Shared Hit\",\"% Local Hit\",  \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\nFROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\", sum(\"shared_blks_hit\")  / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\")) AS \"% Shared Hit\", sum(\"local_blks_hit\")  / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\")) AS \"% Local Hit\" FROM \"$new\".\"pg_stat_statements_diff\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND $timeFilter AND time \u003e now()-1d GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\n),\n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\", sum(\"shared_blks_hit\")  / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\")) AS \"% Shared Hit\", sum(\"local_blks_hit\")  / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\")) AS \"% Local Hit\" FROM \"$archive\".\"pg_stat_statements_diff\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND $timeFilter AND time \u003c now()-1d GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\n)\nWHERE \"Calls\"\u003e0 AND Total\u003e=0 AND $timeFilter ","rawQuery":true,"refId":"B","resultFormat":"table","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["max_time"],"type":"field"},{"params":[],"type":"max"},{"params":["Max"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls\")"],"type":"math"},{"params":["Mean"],"type":"alias"}],[{"params":["shared_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\"))"],"type":"math"},{"params":["% Shared Hit"],"type":"alias"}],[{"params":["local_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\"))"],"type":"math"},{"params":["% Local Hit"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"}]},{"groupBy":[{"params":["queryid"],"type":"tag"}],"hide":false,"measurement":"pg_stat_statements_query_text","orderByTime":"ASC","policy":"autogen","query":"SELECT top(\"${TOP_by}\", ${TOP}), \"Calls\", \"Total\", \"Rows\",\"Mean\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\" FROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$new\".\"pg_stat_statements_diff\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND \"query\" =~/.*${filter:regex}.*/ AND  $timeFilter AND time \u003e now()-$new GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\n),\n(\nSELECT sum(\"calls_sum\") AS \"Calls\", sum(\"duration_sum\") AS \"Total\", sum(\"rows_sum\") AS \"Rows\", sum(\"duration_sum\")  / sum(\"calls_sum\") AS \"Mean\" FROM \"$archive\".\"pg_stat_statements_query_md5_10min\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND  $timeFilter AND time \u003c now()-$new GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\"\n)","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["query"],"type":"field"},{"params":[],"type":"first"},{"params":["query"],"type":"alias"}]],"tags":[{"key":"host","operator":"=~","value":"/^$host$/"}]}],"title":"$db Statistic by query","transformations":[{"id":"organize","options":{"excludeByName":{"Time":true,"top":true},"indexByName":{"Calls":8,"Mean":7,"Rows":9,"Time":0,"Total":6,"datname":1,"query":5,"query_md5":4,"queryid":3,"usename":2},"renameByName":{}}}],"type":"table"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":48},"id":30,"panels":[{"columns":[],"datasource":"$db","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":83,"w":24,"x":0,"y":48},"id":9,"links":[],"pageSize":5,"scroll":true,"showHeader":true,"sort":{"col":5,"desc":true},"styles":[{"$$hashKey":"object:670","alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"hidden"},{"$$hashKey":"object:671","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"mappingType":1,"pattern":"Calls","thresholds":[],"type":"number","unit":"none"},{"$$hashKey":"object:672","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Total","thresholds":[],"type":"number","unit":"ms"},{"$$hashKey":"object:673","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Max","thresholds":[],"type":"number","unit":"ms"},{"$$hashKey":"object:674","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Mean","thresholds":[],"type":"number","unit":"ms"},{"$$hashKey":"object:675","alias":"","align":"auto","colorMode":"cell","colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"% Shared Hit","thresholds":["0.1","0.7"],"type":"number","unit":"percentunit"},{"$$hashKey":"object:676","alias":"","align":"auto","colorMode":"cell","colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"% Local Hit","thresholds":["0.1","0.7"],"type":"number","unit":"percentunit"},{"$$hashKey":"object:677","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"mappingType":1,"pattern":"Rows","thresholds":[],"type":"number","unit":"none"},{"$$hashKey":"object:3406","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"mappingType":1,"pattern":"queryid","thresholds":[],"type":"number","unit":"none"},{"$$hashKey":"object:678","alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"},{"params":["query"],"type":"tag"}],"measurement":"pg_stat_statements_analyse","orderByTime":"ASC","policy":"$new","query":"SELECT \"Calls\", top(${TOP_by}, ${TOP}), \"Total\", \"Rows\",\"Mean\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\" FROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$new\".\"pg_stat_statements_diff\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND \"query\" =~/${filter:regex}/  AND $timeFilter AND time \u003e now()-$new GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\n),\n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration_sum\") AS \"Total\", sum(\"rows_sum\") AS \"Rows\", sum(\"duration_sum\")  / sum(\"calls_sum\") AS \"Mean\" FROM \"$archive\".\"pg_stat_statements_query_md5_10min\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/)  AND $timeFilter AND time \u003c now()-$new GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\"\n)","rawQuery":true,"refId":"B","resultFormat":"table","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["max_time"],"type":"field"},{"params":[],"type":"max"},{"params":["Max"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls\")"],"type":"math"},{"params":["Mean"],"type":"alias"}],[{"params":["shared_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\"))"],"type":"math"},{"params":["% Shared Hit"],"type":"alias"}],[{"params":["local_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\"))"],"type":"math"},{"params":["% Local Hit"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"}]},{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"},{"params":["query"],"type":"tag"}],"hide":true,"measurement":"pg_stat_statements_analyse","orderByTime":"ASC","policy":"$new","query":"","rawQuery":false,"refId":"A","resultFormat":"table","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["max_time"],"type":"field"},{"params":[],"type":"max"},{"params":["Max"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls\")"],"type":"math"},{"params":["Mean"],"type":"alias"}],[{"params":["shared_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\"))"],"type":"math"},{"params":["% Shared Hit"],"type":"alias"}],[{"params":["local_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\"))"],"type":"math"},{"params":["% Local Hit"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"}]},{"groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":true,"orderByTime":"ASC","policy":"default","refId":"C","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]},{"groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":true,"orderByTime":"ASC","policy":"default","refId":"D","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]},{"groupBy":[{"params":["host"],"type":"tag"},{"params":["datname"],"type":"tag"},{"params":["usename"],"type":"tag"},{"params":["query"],"type":"tag"}],"hide":true,"measurement":"pg_stat_statements_analyse","orderByTime":"ASC","policy":"$new","query":"SELECT \"Calls\", \"Total\", \"Rows\",\"Max\",\"Mean\" FROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", max(\"max_time\") AS \"Max\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$new\".\"pg_stat_statements_diff\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND $timeFilter AND time \u003e now()-$new GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\n),\n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", max(\"max_time\") AS \"Max\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$archive\".\"pg_stat_statements_diff\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND $timeFilter AND time \u003c now()-$new GROUP BY \"host\", \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"\n)\nWHERE \"Calls\"\u003e0 AND Total\u003e=0 AND $timeFilter \nGROUP BY \"datname\", \"usename\", \"queryid\", \"query_md5\", \"query\"","rawQuery":true,"refId":"E","resultFormat":"table","select":[[{"params":["calls"],"type":"field"},{"params":[],"type":"sum"},{"params":["Calls"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":["Total"],"type":"alias"}],[{"params":["rows"],"type":"field"},{"params":[],"type":"sum"},{"params":["Rows"],"type":"alias"}],[{"params":["max_time"],"type":"field"},{"params":[],"type":"max"},{"params":["Max"],"type":"alias"}],[{"params":["duration"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / sum(\"calls\")"],"type":"math"},{"params":["Mean"],"type":"alias"}],[{"params":["shared_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\"))"],"type":"math"},{"params":["% Shared Hit"],"type":"alias"}],[{"params":["local_blks_hit"],"type":"field"},{"params":[],"type":"sum"},{"params":[" / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\"))"],"type":"math"},{"params":["% Local Hit"],"type":"alias"}]],"tags":[{"key":"datname","operator":"=~","value":"/^$datname$/"},{"condition":"AND","key":"host","operator":"=~","value":"/^$host$/"},{"condition":"AND","key":"usename","operator":"=~","value":"/^$usename$/"}]}],"title":"$db Statistic by query","transform":"table","transformations":[{"id":"organize","options":{"excludeByName":{"Time":true,"top":true},"indexByName":{"Calls":8,"Mean":7,"Rows":9,"Time":0,"Total":6,"datname":1,"query":5,"query_md5":4,"queryid":3,"usename":2},"renameByName":{}}}],"type":"table-old"}],"title":"Statistics: Query (multiline) - TOP ${TOP} by ${TOP_by}","type":"row"}],"refresh":false,"schemaVersion":27,"style":"dark","tags":["influxdb","PostgreSQL","main"],"templating":{"list":[{"allValue":null,"current":{"selected":false,"text":"","value":""},"description":null,"error":null,"hide":2,"includeAll":true,"label":null,"multi":false,"name":"current","options":[{"selected":false,"text":"All","value":"$__all"},{"selected":false,"text":"/d/pgstat/postgresql-query-statistics","value":"/d/pgstat/postgresql-query-statistics"}],"query":"/d/pgstat/postgresql-query-statistics","queryValue":"","skipUrlSync":false,"type":"custom"},{"allValue":null,"current":{"selected":false,"text":"","value":""},"description":null,"error":null,"hide":2,"includeAll":true,"label":null,"multi":false,"name":"detail","options":[{"selected":false,"text":"All","value":"$__all"},{"selected":false,"text":"/d/pgquery/postgresql-query-details","value":"/d/pgquery/postgresql-query-details"}],"query":"/d/pgquery/postgresql-query-details","queryValue":"","skipUrlSync":false,"type":"custom"},{"current":{"selected":false,"text":"Influx-production-1","value":"Influx-production-1"},"description":null,"error":null,"hide":0,"includeAll":false,"label":"DataBase for annotation","multi":false,"name":"db_jmeter","options":[],"query":"influxdb","queryValue":"","refresh":1,"regex":"/^Stand-.*-JMeter$/i","skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"PostgreSQL Query: Stand-Demo-JMeter","value":"PostgreSQL Query: Stand-Demo-JMeter"},"description":null,"error":null,"hide":2,"includeAll":false,"label":"DataBase","multi":false,"name":"db","options":[],"query":"influxdb","refresh":1,"regex":"/PostgreSQL Query: ${db_jmeter:regex}/i","skipUrlSync":false,"type":"datasource"},{"allValue":null,"current":{"selected":false,"text":"autogen","value":"autogen"},"datasource":"$db","definition":"","description":null,"error":null,"hide":2,"includeAll":false,"label":"Retention policy (archive)","multi":false,"name":"archive","options":[],"query":"SHOW RETENTION POLICIES","refresh":2,"regex":"/^autogen$/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"7d","value":"7d"},"datasource":"$db","definition":"","description":null,"error":null,"hide":2,"includeAll":false,"label":"Retention Policy (new)","multi":false,"name":"new","options":[],"query":"SHOW RETENTION POLICIES","refresh":2,"regex":"/^(?!$archive$).*$/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":"","current":{"selected":true,"text":"All","value":["$__all"]},"datasource":"$db","definition":"SELECT DISTINCT(\"host\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_query_md5_10min\"  WHERE $timeFilter GROUP BY \"host\")","description":null,"error":null,"hide":0,"includeAll":true,"label":"PostgreSQL host","multi":true,"name":"host","options":[],"query":"SELECT DISTINCT(\"host\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_query_md5_10min\"  WHERE $timeFilter GROUP BY \"host\")","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":"","current":{"selected":true,"text":"All","value":["$__all"]},"datasource":"$db","definition":"SELECT DISTINCT(\"datname\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_query_md5_10min\" WHERE \"host\" =~ /^${host:regex}$/   AND $timeFilter GROUP BY \"datname\")","description":null,"error":null,"hide":0,"includeAll":true,"label":"PostgreSQL DB","multi":true,"name":"datname","options":[],"query":"SELECT DISTINCT(\"datname\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_query_md5_10min\" WHERE \"host\" =~ /^${host:regex}$/   AND $timeFilter GROUP BY \"datname\")","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":"","current":{"selected":true,"text":"All","value":["$__all"]},"datasource":"$db","definition":"SELECT DISTINCT(\"usename\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_query_md5_10min\" WHERE \"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/  AND $timeFilter GROUP BY \"usename\")","description":null,"error":null,"hide":0,"includeAll":true,"label":"PostgreSQL User","multi":true,"name":"usename","options":[],"query":"SELECT DISTINCT(\"usename\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_query_md5_10min\" WHERE \"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/  AND $timeFilter GROUP BY \"usename\")","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"SELECT DISTINCT(\"usename\") FROM (SELECT last(\"calls_10m\") FROM \"${archive}\".\"pg_stat_statements_query_md5\" WHERE \"datname\" =~ /^${tag:regex}$/  AND \"host\" =~ /^${host:regex}$/ AND $timeFilter GROUP BY \"usename\")","tags":[],"tagsQuery":"SELECT DISTINCT(\"datname\") FROM (SELECT last(\"calls_10m\") FROM \"${archive}\".\"pg_stat_statements_query_md5\" WHERE \"datname\" =~ /^${datname:regex}$/  AND \"host\" =~ /^${host:regex}$/ AND $timeFilter GROUP BY \"datname\")","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"10","value":"10"},"description":null,"error":null,"hide":0,"includeAll":false,"label":null,"multi":false,"name":"TOP","options":[{"selected":false,"text":"10","value":"10"},{"selected":true,"text":"20","value":"20"},{"selected":false,"text":"30","value":"30"},{"selected":false,"text":"40","value":"40"},{"selected":false,"text":"50","value":"50"},{"selected":false,"text":"100","value":"100"},{"selected":false,"text":"200","value":"200"}],"query":"10,20,30,40,50,100,200","queryValue":"","skipUrlSync":false,"type":"custom"},{"allValue":null,"current":{"selected":false,"text":"Total","value":"Total"},"description":null,"error":null,"hide":0,"includeAll":false,"label":"TOP by","multi":false,"name":"TOP_by","options":[{"selected":false,"text":"Total","value":"Total"},{"selected":true,"text":"Calls","value":"Calls"},{"selected":false,"text":"Mean","value":"Mean"},{"selected":false,"text":"Rows","value":"Rows"}],"query":"Total, Calls, Mean, Rows","queryValue":"","skipUrlSync":false,"type":"custom"},{"current":{"selected":false,"text":"","value":""},"description":null,"error":null,"hide":0,"label":"Filter","name":"filter","options":[{"selected":true,"text":"","value":""}],"query":"","skipUrlSync":false,"type":"textbox"}]},"time":{"from":"2020-11-11T12:24:09.228Z","to":"2020-11-11T13:13:06.986Z"},"timepicker":{"refresh_intervals":["10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"PostgreSQL Query Statistics","uid":"pgstat","version":2}}
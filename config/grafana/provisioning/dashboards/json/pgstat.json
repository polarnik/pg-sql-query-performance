{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": false,
        "iconColor": "#E02F44",
        "limit": 100,
        "matchAny": true,
        "name": "Events (Demo stand)",
        "query": "select text,generatorHost,application,title FROM (select text from events where $timeFilter and \"text\" =~ /.*started$/ GROUP BY generatorHost,application,title)",
        "showIn": 0,
        "tags": [],
        "tagsColumn": "generatorHost,application,title",
        "textColumn": "text",
        "type": "tags"
      }
    ]
  },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 2,
  "id": 3,
  "iteration": 1624631731362,
  "links": [],
  "panels": [
    {
      "datasource": "$db",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 14,
        "x": 0,
        "y": 0
      },
      "id": 32,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "/.*/",
          "values": false
        },
        "text": {},
        "textMode": "auto"
      },
      "pluginVersion": "",
      "targets": [
        {
          "groupBy": [
            {
              "params": [
                "host"
              ],
              "type": "tag"
            }
          ],
          "measurement": "pg_stat_statements_query_md5",
          "orderByTime": "ASC",
          "policy": "$archive",
          "query": "SELECT \"host\", top(\"factor\", 1) FROM\n(SELECT (sum(\"duration\")*sum(\"calls\")) as \"factor\" FROM \"$archive\".\"pg_stat_statements_diff_1m_archive\" WHERE $timeFilter GROUP BY \"host\")",
          "rawQuery": true,
          "refId": "A",
          "resultFormat": "table",
          "select": [
            [
              {
                "params": [
                  "duration_10m"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              }
            ],
            [
              {
                "params": [
                  "calls_10m"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              }
            ]
          ],
          "tags": []
        }
      ],
      "timeFrom": null,
      "timeShift": null,
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "top": true
            },
            "indexByName": {},
            "renameByName": {
              "host": "Host (master):"
            }
          }
        }
      ],
      "transparent": true,
      "type": "stat"
    },
    {
      "collapsed": false,
      "datasource": null,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 2
      },
      "id": 28,
      "panels": [],
      "title": "Statistics: Host / Database / User",
      "type": "row"
    },
    {
      "aliasColors": {},
      "bars": false,
      "dashLength": 10,
      "dashes": false,
      "datasource": "${db}",
      "fill": 10,
      "fillGradient": 10,
      "gridPos": {
        "h": 5,
        "w": 12,
        "x": 0,
        "y": 3
      },
      "hiddenSeries": false,
      "id": 14,
      "interval": "3m",
      "legend": {
        "alignAsTable": true,
        "avg": false,
        "current": false,
        "hideEmpty": true,
        "hideZero": true,
        "max": true,
        "min": false,
        "rightSide": true,
        "show": true,
        "sideWidth": 230,
        "sort": "max",
        "sortDesc": true,
        "total": false,
        "values": true
      },
      "lines": true,
      "linewidth": 6,
      "links": [],
      "maxDataPoints": 200,
      "nullPointMode": "null",
      "options": {
        "alertThreshold": true
      },
      "percentage": false,
      "pluginVersion": "",
      "pointradius": 5,
      "points": false,
      "renderer": "flot",
      "seriesOverrides": [],
      "spaceLength": 10,
      "stack": false,
      "steppedLine": true,
      "targets": [
        {
          "alias": "$tag_host",
          "groupBy": [
            {
              "params": [
                "$__interval"
              ],
              "type": "time"
            },
            {
              "params": [
                "host"
              ],
              "type": "tag"
            },
            {
              "params": [
                "null"
              ],
              "type": "fill"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_diff_1m_archive",
          "orderByTime": "ASC",
          "policy": "$archive",
          "refId": "C",
          "resultFormat": "time_series",
          "select": [
            [
              {
                "params": [
                  "duration"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  " *60 /( $__interval_ms / 1000)/10"
                ],
                "type": "math"
              }
            ]
          ],
          "tags": [
            {
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            }
          ]
        }
      ],
      "thresholds": [],
      "timeFrom": null,
      "timeRegions": [],
      "timeShift": null,
      "title": "Total Duration / min",
      "tooltip": {
        "shared": true,
        "sort": 2,
        "value_type": "individual"
      },
      "transparent": true,
      "type": "graph",
      "xaxis": {
        "buckets": null,
        "mode": "time",
        "name": null,
        "show": true,
        "values": []
      },
      "yaxes": [
        {
          "$$hashKey": "object:666",
          "format": "ms",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": null,
          "show": true
        },
        {
          "$$hashKey": "object:667",
          "format": "short",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": null,
          "show": true
        }
      ],
      "yaxis": {
        "align": false,
        "alignLevel": null
      }
    },
    {
      "aliasColors": {},
      "bars": false,
      "dashLength": 10,
      "dashes": false,
      "datasource": "$db",
      "decimals": 1,
      "fill": 6,
      "fillGradient": 10,
      "gridPos": {
        "h": 5,
        "w": 12,
        "x": 12,
        "y": 3
      },
      "hiddenSeries": false,
      "id": 13,
      "interval": "3m",
      "legend": {
        "alignAsTable": true,
        "avg": false,
        "current": false,
        "hideEmpty": true,
        "hideZero": true,
        "max": true,
        "min": false,
        "rightSide": true,
        "show": true,
        "sideWidth": 230,
        "sort": "max",
        "sortDesc": true,
        "total": false,
        "values": true
      },
      "lines": true,
      "linewidth": 6,
      "links": [],
      "maxDataPoints": 200,
      "nullPointMode": "null",
      "options": {
        "alertThreshold": true
      },
      "percentage": false,
      "pluginVersion": "",
      "pointradius": 5,
      "points": false,
      "renderer": "flot",
      "seriesOverrides": [],
      "spaceLength": 10,
      "stack": false,
      "steppedLine": true,
      "targets": [
        {
          "alias": "$tag_host",
          "groupBy": [
            {
              "params": [
                "$__interval"
              ],
              "type": "time"
            },
            {
              "params": [
                "host"
              ],
              "type": "tag"
            },
            {
              "params": [
                "null"
              ],
              "type": "fill"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_diff_1m_archive",
          "orderByTime": "ASC",
          "policy": "$archive",
          "refId": "B",
          "resultFormat": "time_series",
          "select": [
            [
              {
                "params": [
                  "calls"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "  / ($__interval_ms / 1000)"
                ],
                "type": "math"
              }
            ]
          ],
          "tags": [
            {
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            }
          ]
        }
      ],
      "thresholds": [],
      "timeFrom": null,
      "timeRegions": [],
      "timeShift": null,
      "title": "Total Calls / sec",
      "tooltip": {
        "shared": true,
        "sort": 2,
        "value_type": "individual"
      },
      "transparent": true,
      "type": "graph",
      "xaxis": {
        "buckets": null,
        "mode": "time",
        "name": null,
        "show": true,
        "values": []
      },
      "yaxes": [
        {
          "$$hashKey": "object:778",
          "format": "ops",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": null,
          "show": true
        },
        {
          "$$hashKey": "object:779",
          "format": "short",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": null,
          "show": false
        }
      ],
      "yaxis": {
        "align": false,
        "alignLevel": null
      }
    },
    {
      "aliasColors": {},
      "bars": false,
      "dashLength": 10,
      "dashes": false,
      "datasource": "$db",
      "decimals": 2,
      "fill": 3,
      "fillGradient": 10,
      "gridPos": {
        "h": 5,
        "w": 12,
        "x": 0,
        "y": 8
      },
      "hiddenSeries": false,
      "id": 12,
      "interval": "3m",
      "legend": {
        "alignAsTable": true,
        "avg": false,
        "current": false,
        "hideEmpty": true,
        "hideZero": true,
        "max": true,
        "min": false,
        "rightSide": true,
        "show": true,
        "sideWidth": 230,
        "sort": "max",
        "sortDesc": true,
        "total": false,
        "values": true
      },
      "lines": true,
      "linewidth": 6,
      "links": [],
      "maxDataPoints": 200,
      "nullPointMode": "null",
      "options": {
        "alertThreshold": true
      },
      "percentage": false,
      "pluginVersion": "",
      "pointradius": 5,
      "points": false,
      "renderer": "flot",
      "seriesOverrides": [],
      "spaceLength": 10,
      "stack": true,
      "steppedLine": true,
      "targets": [
        {
          "alias": "$tag_datname",
          "groupBy": [
            {
              "params": [
                "$__interval"
              ],
              "type": "time"
            },
            {
              "params": [
                "datname"
              ],
              "type": "tag"
            },
            {
              "params": [
                "null"
              ],
              "type": "fill"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_diff_1m_archive",
          "orderByTime": "ASC",
          "policy": "$archive",
          "refId": "B",
          "resultFormat": "time_series",
          "select": [
            [
              {
                "params": [
                  "duration"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  " * 60 / ($__interval_ms / 1000)/10"
                ],
                "type": "math"
              }
            ]
          ],
          "tags": [
            {
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            },
            {
              "condition": "AND",
              "key": "datname",
              "operator": "=~",
              "value": "/^$datname$/"
            }
          ]
        }
      ],
      "thresholds": [],
      "timeFrom": null,
      "timeRegions": [],
      "timeShift": null,
      "title": "Total Duration / min",
      "tooltip": {
        "shared": true,
        "sort": 2,
        "value_type": "individual"
      },
      "type": "graph",
      "xaxis": {
        "buckets": null,
        "mode": "time",
        "name": null,
        "show": true,
        "values": []
      },
      "yaxes": [
        {
          "$$hashKey": "object:2226",
          "format": "ms",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": "0",
          "show": true
        },
        {
          "$$hashKey": "object:2227",
          "format": "short",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": null,
          "show": true
        }
      ],
      "yaxis": {
        "align": false,
        "alignLevel": null
      }
    },
    {
      "aliasColors": {},
      "bars": false,
      "dashLength": 10,
      "dashes": false,
      "datasource": "$db",
      "decimals": 1,
      "fill": 3,
      "fillGradient": 10,
      "gridPos": {
        "h": 5,
        "w": 12,
        "x": 12,
        "y": 8
      },
      "hiddenSeries": false,
      "id": 15,
      "interval": "3m",
      "legend": {
        "alignAsTable": true,
        "avg": false,
        "current": false,
        "hideEmpty": true,
        "hideZero": true,
        "max": true,
        "min": false,
        "rightSide": true,
        "show": true,
        "sideWidth": 230,
        "sort": "total",
        "sortDesc": true,
        "total": false,
        "values": true
      },
      "lines": true,
      "linewidth": 6,
      "links": [],
      "maxDataPoints": 200,
      "nullPointMode": "null",
      "options": {
        "alertThreshold": true
      },
      "percentage": false,
      "pluginVersion": "",
      "pointradius": 5,
      "points": false,
      "renderer": "flot",
      "seriesOverrides": [],
      "spaceLength": 10,
      "stack": true,
      "steppedLine": true,
      "targets": [
        {
          "alias": "$tag_datname",
          "groupBy": [
            {
              "params": [
                "$__interval"
              ],
              "type": "time"
            },
            {
              "params": [
                "datname"
              ],
              "type": "tag"
            },
            {
              "params": [
                "null"
              ],
              "type": "fill"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_diff_1m_archive",
          "orderByTime": "ASC",
          "policy": "$archive",
          "refId": "A",
          "resultFormat": "time_series",
          "select": [
            [
              {
                "params": [
                  "calls"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "/ ($__interval_ms / 1000)"
                ],
                "type": "math"
              }
            ]
          ],
          "tags": [
            {
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            },
            {
              "condition": "AND",
              "key": "datname",
              "operator": "=~",
              "value": "/^$datname$/"
            }
          ]
        }
      ],
      "thresholds": [],
      "timeFrom": null,
      "timeRegions": [],
      "timeShift": null,
      "title": "Total Calls / sec",
      "tooltip": {
        "shared": true,
        "sort": 2,
        "value_type": "individual"
      },
      "type": "graph",
      "xaxis": {
        "buckets": null,
        "mode": "time",
        "name": null,
        "show": true,
        "values": []
      },
      "yaxes": [
        {
          "$$hashKey": "object:887",
          "format": "ops",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": "0",
          "show": true
        },
        {
          "$$hashKey": "object:888",
          "format": "short",
          "label": null,
          "logBase": 1,
          "max": null,
          "min": null,
          "show": false
        }
      ],
      "yaxis": {
        "align": false,
        "alignLevel": null
      }
    },
    {
      "columns": [],
      "datasource": "$db",
      "fontSize": "100%",
      "gridPos": {
        "h": 6,
        "w": 24,
        "x": 0,
        "y": 13
      },
      "id": 8,
      "interval": "10m",
      "links": [],
      "pageSize": 5,
      "scroll": false,
      "showHeader": true,
      "sort": {
        "col": 4,
        "desc": true
      },
      "styles": [
        {
          "$$hashKey": "object:300",
          "alias": "Time",
          "align": "auto",
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "pattern": "Time",
          "type": "hidden"
        },
        {
          "$$hashKey": "object:301",
          "alias": "",
          "align": "auto",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 0,
          "mappingType": 1,
          "pattern": "Calls",
          "thresholds": [],
          "type": "number",
          "unit": "none"
        },
        {
          "$$hashKey": "object:302",
          "alias": "",
          "align": "auto",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Total",
          "thresholds": [],
          "type": "number",
          "unit": "ms"
        },
        {
          "$$hashKey": "object:303",
          "alias": "",
          "align": "auto",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Max",
          "thresholds": [],
          "type": "number",
          "unit": "ms"
        },
        {
          "$$hashKey": "object:304",
          "alias": "",
          "align": "auto",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Mean",
          "thresholds": [],
          "type": "number",
          "unit": "ms"
        },
        {
          "$$hashKey": "object:305",
          "alias": "",
          "align": "auto",
          "colorMode": "cell",
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "% Shared Hit",
          "thresholds": [
            "0.1",
            "0.7"
          ],
          "type": "number",
          "unit": "percentunit"
        },
        {
          "$$hashKey": "object:306",
          "alias": "",
          "align": "auto",
          "colorMode": "cell",
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "% Local Hit",
          "thresholds": [
            "0.1",
            "0.7"
          ],
          "type": "number",
          "unit": "percentunit"
        },
        {
          "$$hashKey": "object:307",
          "alias": "",
          "align": "auto",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 0,
          "mappingType": 1,
          "pattern": "Rows",
          "thresholds": [],
          "type": "number",
          "unit": "none"
        },
        {
          "$$hashKey": "object:308",
          "alias": "",
          "align": "auto",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "decimals": 2,
          "pattern": "/.*/",
          "thresholds": [],
          "type": "number",
          "unit": "short"
        }
      ],
      "targets": [
        {
          "groupBy": [
            {
              "params": [
                "host"
              ],
              "type": "tag"
            },
            {
              "params": [
                "datname"
              ],
              "type": "tag"
            },
            {
              "params": [
                "usename"
              ],
              "type": "tag"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_diff_1m_archive",
          "orderByTime": "ASC",
          "policy": "$archive",
          "query": "",
          "rawQuery": false,
          "refId": "A",
          "resultFormat": "table",
          "select": [
            [
              {
                "params": [
                  "calls"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "Calls"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "duration"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "Total"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "rows"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "Rows"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "duration"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  " / sum(\"calls\")"
                ],
                "type": "math"
              },
              {
                "params": [
                  "Mean"
                ],
                "type": "alias"
              }
            ]
          ],
          "tags": [
            {
              "key": "datname",
              "operator": "=~",
              "value": "/^$datname$/"
            },
            {
              "condition": "AND",
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            },
            {
              "condition": "AND",
              "key": "usename",
              "operator": "=~",
              "value": "/^$usename$/"
            }
          ]
        }
      ],
      "title": "$db Statistic",
      "transform": "table",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "indexByName": {
              "Calls": 5,
              "Max": 8,
              "Mean": 6,
              "Rows": 7,
              "Time": 0,
              "Total": 4,
              "datname": 2,
              "host": 1,
              "usename": 3
            },
            "renameByName": {}
          }
        }
      ],
      "transparent": true,
      "type": "table-old"
    },
    {
      "collapsed": false,
      "datasource": null,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 19
      },
      "id": 24,
      "panels": [],
      "title": "Statistics: Query - TOP ${TOP} by ${TOP_by}",
      "type": "row"
    },
    {
      "datasource": "$db",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": null,
            "displayMode": "auto",
            "filterable": false,
            "width": 95
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Rows"
            },
            "properties": [
              {
                "id": "unit",
                "value": "short"
              },
              {
                "id": "decimals",
                "value": 1
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Total"
            },
            "properties": [
              {
                "id": "unit",
                "value": "ms"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "query"
            },
            "properties": [
              {
                "id": "custom.width"
              },
              {
                "id": "custom.displayMode",
                "value": "color-text"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Mean"
            },
            "properties": [
              {
                "id": "unit",
                "value": "ms"
              },
              {
                "id": "decimals",
                "value": 1
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "host"
            },
            "properties": [
              {
                "id": "links",
                "value": [
                  {
                    "targetBlank": false,
                    "title": "host: ${__data.fields[host]} (filter)",
                    "url": "/d/pgstat?from=${__from}&to=${__to}&var-db=${db:percentencode}&var-host=${__data.fields[host]:percentencode}&var-datname=${datname:percentencode}&var-usename=${usename:percentencode}&var-archive=${archive:percentencode}&var-new=${new:percentencode}&var-TOP=${TOP:percentencode}&var-TOP_by=${TOP_by:percentencode}"
                  }
                ]
              },
              {
                "id": "custom.width",
                "value": 53
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "datname"
            },
            "properties": [
              {
                "id": "links",
                "value": [
                  {
                    "title": "host: ${__data.fields[host]} + datname: ${__data.fields[datname]} (filter)",
                    "url": "/d/pgstat?from=${__from}&to=${__to}&var-db=${db:percentencode}&var-host=${__data.fields[host]:percentencode}&var-datname=${__data.fields[datname]:percentencode}&var-usename=${usename:percentencode}&var-archive=${archive:percentencode}&var-new=${new:percentencode}&var-TOP=${TOP:percentencode}&var-TOP_by=${TOP_by:percentencode}"
                  }
                ]
              },
              {
                "id": "custom.width",
                "value": 80
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "queryid"
            },
            "properties": [
              {
                "id": "links",
                "value": [
                  {
                    "targetBlank": true,
                    "title": "SQL Stats Details for queryid=﻿${__data.fields[queryid]}",
                    "url": "/d/pgquery?from=${__from}﻿&to=﻿${__to}﻿﻿&var-db=﻿${db:percentencode}﻿&var-host=﻿${__data.fields[host]:percentencode}﻿&var-datname=﻿${__data.fields[datname]:percentencode}﻿&var-usename=﻿${__data.fields[usename]:percentencode}﻿&var-queryid=﻿${__data.fields[queryid]:percentencode}"
                  }
                ]
              },
              {
                "id": "custom.width",
                "value": 73
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "usename"
            },
            "properties": [
              {
                "id": "links",
                "value": [
                  {
                    "title": "host: ${__data.fields[host]} + datname: ${__data.fields[datname]} + usename: ${__data.fields[usename]} (filter)",
                    "url": "/d/pgstat?from=${__from}&to=${__to}&var-db=${db:percentencode}&var-host=${__data.fields[host]:percentencode}&var-datname=${__data.fields[datname]:percentencode}&var-usename=${__data.fields[usename]:percentencode}&var-archive=${archive:percentencode}&var-new=${new:percentencode}&var-TOP=${TOP}&var-TOP_by=${TOP_by}"
                  }
                ]
              },
              {
                "id": "custom.width",
                "value": 187
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Calls"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 1
              },
              {
                "id": "unit",
                "value": "short"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "query_md5"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 81
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 28,
        "w": 24,
        "x": 0,
        "y": 20
      },
      "id": 22,
      "links": [],
      "options": {
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "usename"
          }
        ]
      },
      "pluginVersion": "",
      "targets": [
        {
          "groupBy": [
            {
              "params": [
                "host"
              ],
              "type": "tag"
            },
            {
              "params": [
                "datname"
              ],
              "type": "tag"
            },
            {
              "params": [
                "usename"
              ],
              "type": "tag"
            },
            {
              "params": [
                "query"
              ],
              "type": "tag"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_analyse",
          "orderByTime": "ASC",
          "policy": "$new",
          "query": "SELECT top(\"${TOP_by}\", ${TOP}), \"Calls\", \"Total\", \"Rows\",\"Mean\", \"host\", \"datname\", \"usename\", \"queryid\" FROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$archive\".\"pg_stat_statements_diff_1m_archive\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND  $timeFilter GROUP BY \"host\", \"datname\", \"usename\", \"queryid\"\n)",
          "rawQuery": true,
          "refId": "B",
          "resultFormat": "table",
          "select": [
            [
              {
                "params": [
                  "calls"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "Calls"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "duration"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "Total"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "rows"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  "Rows"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "max_time"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "max"
              },
              {
                "params": [
                  "Max"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "duration"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  " / sum(\"calls\")"
                ],
                "type": "math"
              },
              {
                "params": [
                  "Mean"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "shared_blks_hit"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  " / ( sum(\"shared_blks_hit\") + sum(\"shared_blks_read\"))"
                ],
                "type": "math"
              },
              {
                "params": [
                  "% Shared Hit"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "local_blks_hit"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "sum"
              },
              {
                "params": [
                  " / ( sum(\"local_blks_hit\") + sum(\"local_blks_read\"))"
                ],
                "type": "math"
              },
              {
                "params": [
                  "% Local Hit"
                ],
                "type": "alias"
              }
            ]
          ],
          "tags": [
            {
              "key": "datname",
              "operator": "=~",
              "value": "/^$datname$/"
            },
            {
              "condition": "AND",
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            },
            {
              "condition": "AND",
              "key": "usename",
              "operator": "=~",
              "value": "/^$usename$/"
            }
          ]
        },
        {
          "groupBy": [
            {
              "params": [
                "1000d"
              ],
              "type": "time"
            },
            {
              "params": [
                "query_md5"
              ],
              "type": "tag"
            },
            {
              "params": [
                "query"
              ],
              "type": "tag"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_query_10m",
          "orderByTime": "ASC",
          "policy": "1d",
          "query": "SELECT last(\"query\") as \"query\" FROM\n(SELECT last(\"calls_sum\") AS \"XXXXX\" FROM \"1d\".\"pg_stat_statements_query_10m\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"queryid\" =~ /^${queryid:regex}$/ AND \"query\" =~ /${filter:regex}/) AND $timeFilter AND \"time\" >= now()-24h GROUP BY time(1000d), \"queryid\", \"query\"),\n(SELECT last(\"calls_sum\") AS \"XXXXX\" FROM \"archive\".\"pg_stat_statements_query_1d\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"queryid\" =~ /^${queryid:regex}$/ AND \"query\" =~ /${filter:regex}/ AND \"time\" < now()-24h) AND $timeFilter GROUP BY time(1000d), \"queryid\", \"query\")\nWHERE $timeFilter\nGROUP BY time(1000d), \"queryid\"",
          "rawQuery": true,
          "refId": "C",
          "resultFormat": "table",
          "select": [
            [
              {
                "params": [
                  "calls_sum"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "last"
              },
              {
                "params": [
                  "XXXXX"
                ],
                "type": "alias"
              }
            ]
          ],
          "tags": [
            {
              "key": "datname",
              "operator": "=~",
              "value": "/^$datname$/"
            },
            {
              "condition": "AND",
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            },
            {
              "condition": "AND",
              "key": "query_md5",
              "operator": "=~",
              "value": "/^$query_md5$/"
            },
            {
              "condition": "AND",
              "key": "query",
              "operator": "=~",
              "value": "/^$filter$/"
            }
          ]
        },
        {
          "groupBy": [
            {
              "params": [
                "1000d"
              ],
              "type": "time"
            },
            {
              "params": [
                "query_md5"
              ],
              "type": "tag"
            },
            {
              "params": [
                "query"
              ],
              "type": "tag"
            }
          ],
          "hide": false,
          "measurement": "pg_stat_statements_query_1d",
          "orderByTime": "ASC",
          "policy": "autogen",
          "query": "",
          "rawQuery": true,
          "refId": "D",
          "resultFormat": "table",
          "select": [
            [
              {
                "params": [
                  "calls_sum"
                ],
                "type": "field"
              },
              {
                "params": [],
                "type": "last"
              },
              {
                "params": [
                  "XXXXX"
                ],
                "type": "alias"
              }
            ]
          ],
          "tags": [
            {
              "key": "datname",
              "operator": "=~",
              "value": "/^$datname$/"
            },
            {
              "condition": "AND",
              "key": "host",
              "operator": "=~",
              "value": "/^$host$/"
            },
            {
              "condition": "AND",
              "key": "query_md5",
              "operator": "=~",
              "value": "/^$query_md5$/"
            },
            {
              "condition": "AND",
              "key": "time",
              "operator": "<",
              "value": "now()-1d"
            }
          ]
        }
      ],
      "title": "$db Statistic by query",
      "transformations": [
        {
          "id": "seriesToColumns",
          "options": {
            "byField": "queryid"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "XXXXX": true,
              "XXXXX 1": true,
              "XXXXX 2": true,
              "top": true
            },
            "indexByName": {
              "Calls": 6,
              "Mean": 9,
              "Rows": 8,
              "Time 1": 12,
              "Time 2": 11,
              "Total": 7,
              "XXXXX": 13,
              "datname": 1,
              "host": 0,
              "query": 5,
              "query_md5": 4,
              "queryid": 3,
              "top": 10,
              "usename": 2
            },
            "renameByName": {}
          }
        }
      ],
      "type": "table"
    }
  ],
  "refresh": false,
  "schemaVersion": 30,
  "style": "dark",
  "tags": [
    "influxdb",
    "PostgreSQL",
    "main"
  ],
  "templating": {
    "list": [
      {
        "allValue": null,
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "description": null,
        "error": null,
        "hide": 2,
        "includeAll": true,
        "label": null,
        "multi": false,
        "name": "current",
        "options": [
          {
            "selected": false,
            "text": "All",
            "value": "$__all"
          },
          {
            "selected": false,
            "text": "/d/pgstat",
            "value": "/d/pgstat"
          }
        ],
        "query": "/d/pgstat",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "allValue": null,
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "description": null,
        "error": null,
        "hide": 2,
        "includeAll": true,
        "label": null,
        "multi": false,
        "name": "detail",
        "options": [
          {
            "selected": false,
            "text": "All",
            "value": "$__all"
          },
          {
            "selected": false,
            "text": "/d/pgquery",
            "value": "/d/pgquery"
          }
        ],
        "query": "/d/pgquery",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": false,
          "text": "PostgreSQL Query: Stand-Demo-JMeter",
          "value": "PostgreSQL Query: Stand-Demo-JMeter"
        },
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": false,
        "label": "DataBase",
        "multi": false,
        "name": "db",
        "options": [],
        "query": "influxdb",
        "queryValue": "",
        "refresh": 1,
        "regex": "/PostgreSQL Query: .*/i",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "description": null,
        "error": null,
        "hide": 2,
        "label": "Retention policy (archive)",
        "name": "archive",
        "query": "archive",
        "skipUrlSync": false,
        "type": "constant"
      },
      {
        "description": null,
        "error": null,
        "hide": 2,
        "label": "Retention Policy (new)",
        "name": "new",
        "query": "1d",
        "skipUrlSync": false,
        "type": "constant"
      },
      {
        "allValue": null,
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": "${db}",
        "definition": "SELECT DISTINCT(\"host\") FROM (SELECT last(\"calls_sum\") FROM \"archive\".\"pg_stat_statements_filters\" WHERE  $timeFilter GROUP BY \"host\")",
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": true,
        "label": "PostgreSQL host",
        "multi": true,
        "name": "host",
        "options": [],
        "query": "SELECT DISTINCT(\"host\") FROM (SELECT last(\"calls_sum\") FROM \"archive\".\"pg_stat_statements_filters\" WHERE  $timeFilter GROUP BY \"host\")",
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": "",
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": "$db",
        "definition": "SELECT DISTINCT(\"datname\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_filters\" WHERE \"host\" =~ /^${host:regex}$/   AND $timeFilter GROUP BY \"datname\")",
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": true,
        "label": "PostgreSQL DB",
        "multi": true,
        "name": "datname",
        "options": [],
        "query": "SELECT DISTINCT(\"datname\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_filters\" WHERE \"host\" =~ /^${host:regex}$/   AND $timeFilter GROUP BY \"datname\")",
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": "",
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": "$db",
        "definition": "SELECT DISTINCT(\"usename\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_filters\" WHERE \"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/  AND $timeFilter GROUP BY \"usename\")",
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": true,
        "label": "PostgreSQL User",
        "multi": true,
        "name": "usename",
        "options": [],
        "query": "SELECT DISTINCT(\"usename\") FROM (SELECT last(\"calls_sum\") FROM \"${archive}\".\"pg_stat_statements_filters\" WHERE \"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/  AND $timeFilter GROUP BY \"usename\")",
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": null,
        "current": {
          "selected": false,
          "text": "20",
          "value": "20"
        },
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": false,
        "label": null,
        "multi": false,
        "name": "TOP",
        "options": [
          {
            "selected": false,
            "text": "10",
            "value": "10"
          },
          {
            "selected": false,
            "text": "20",
            "value": "20"
          },
          {
            "selected": false,
            "text": "30",
            "value": "30"
          },
          {
            "selected": true,
            "text": "40",
            "value": "40"
          },
          {
            "selected": false,
            "text": "50",
            "value": "50"
          },
          {
            "selected": false,
            "text": "100",
            "value": "100"
          },
          {
            "selected": false,
            "text": "200",
            "value": "200"
          }
        ],
        "query": "10,20,30,40,50,100,200",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "allValue": null,
        "current": {
          "selected": true,
          "text": "Total",
          "value": "Total"
        },
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": false,
        "label": "TOP by",
        "multi": false,
        "name": "TOP_by",
        "options": [
          {
            "selected": true,
            "text": "Total",
            "value": "Total"
          },
          {
            "selected": false,
            "text": "Calls",
            "value": "Calls"
          },
          {
            "selected": false,
            "text": "Mean",
            "value": "Mean"
          },
          {
            "selected": false,
            "text": "Rows",
            "value": "Rows"
          }
        ],
        "query": "Total, Calls, Mean, Rows",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "description": null,
        "error": null,
        "hide": 0,
        "label": "Filter",
        "name": "filter",
        "options": [
          {
            "selected": true,
            "text": "",
            "value": ""
          }
        ],
        "query": "",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "allValue": null,
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": "${db}",
        "definition": "SELECT \"queryid\", top(\"${TOP_by}\", ${TOP}) FROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$archive\".\"pg_stat_statements_diff_1m_archive\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND  $timeFilter GROUP BY \"host\", \"datname\", \"usename\", \"queryid\"\n)",
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": true,
        "label": "queryid",
        "multi": true,
        "name": "queryid",
        "options": [],
        "query": "SELECT \"queryid\", top(\"${TOP_by}\", ${TOP}) FROM \n(\nSELECT sum(\"calls\") AS \"Calls\", sum(\"duration\") AS \"Total\", sum(\"rows\") AS \"Rows\", sum(\"duration\")  / sum(\"calls\") AS \"Mean\" FROM \"$archive\".\"pg_stat_statements_diff_1m_archive\" WHERE (\"datname\" =~ /^${datname:regex}$/ AND \"host\" =~ /^${host:regex}$/ AND \"usename\" =~ /^${usename:regex}$/) AND  $timeFilter GROUP BY \"host\", \"datname\", \"usename\", \"queryid\"\n)",
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      }
    ]
  },
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h",
      "2h",
      "1d"
    ],
    "time_options": [
      "5m",
      "15m",
      "1h",
      "6h",
      "12h",
      "24h",
      "2d",
      "7d",
      "30d"
    ]
  },
  "timezone": "",
  "title": "PostgreSQL Statistics",
  "uid": "pgstat",
  "version": 8
}
